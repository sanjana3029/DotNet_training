CREATE DATABASE CODINGTEST


--3 Display the Name for the customer from above customer table who live in 
--same address which has character o anywhere in address

CREATE TABLE CUSTOMER(
ID INT PRIMARY KEY,
CNAME VARCHAR(25),
AGE NUMERIC,
CADDRESS VARCHAR(25),
SALARY DECIMAL(10,2)
);

INSERT INTO CUSTOMER(ID,CNAME,AGE,CADDRESS,SALARY )
VALUES(1 ,'RAMESH', 32, 'AHMEDABAD',2000.00),(2 ,'KHILAN', 25, 'DELHI',1500.00),
(3 ,'KAUSHIK', 23, 'KOTA',2000.00),(4 ,'CHAITALI', 25, 'MUMBAI',6500.00),
(5,'HARDIK', 27, 'BHOPAL',8500.00),(6,'KOMAL', 22, 'MP',4500.00),
(7 ,'MUFFY', 24, 'INDORE',10000.00);

SELECT * FROM CUSTOMER

SELECT CNAME, CADDRESS
FROM CUSTOMER
WHERE CADDRESS LIKE '%O%';


---- 1. Write a query to fetch the details of the books written by authors whose name ends with "er."

CREATE TABLE BOOKS (
ID INT PRIMARY KEY,
TITLE VARCHAR(50), 
AUTHOR VARCHAR(50), 
ISBN NUMERIC,
PUBLISHED_DATE DATE
);

INSERT INTO BOOKS (ID, TITLE, AUTHOR, ISBN, PUBLISHED_DATE)
VALUES (1, 'MY FIRST SQL BOOK', 'MARY PARKER', 981483029127, '2012-02-22 12:08:17'),
(2, 'MY SECOND SQL BOOK', 'JOHN MAYER', 857300923713, '1972-07-03 09:22:45'),
(3, 'MY THIRD SQL BOOK', 'CARY FLINT', 523120967812, '2015-10-18 14:05:44');

SELECT * FROM BOOKS;

SELECT *
FROM BOOKS
WHERE UPPER(AUTHOR) LIKE '%ER';


--REVIEW TABLE
CREATE TABLE REVIEW ( ID INT,
BOOKID INT,
REVIEWER_NAME VARCHAR(30),
CONTENT VARCHAR(50),
RATING INT,
PUBLISHED_DATE DATETIME,
FOREIGN KEY (BOOKID) REFERENCES BOOKS(ID)
);

INSERT INTO REVIEW (ID, BOOKID,REVIEWER_NAME,CONTENT,RATING,PUBLISHED_DATE)
VALUES(1, 1, 'JOHN SMITH', 'MY FIRST REVIEW', 4, '2017-12-10 05:50:11'),
(2, 2, 'JOHN SMITH', 'MY SECOND REVIEW', 5, '2017-10-13 15:05:12'),
(3, 2, 'ALICE REVIEW', 'ANOTHER FREVIEW ', 1, '2017-10-22 23:47:10');

SELECT * FROM REVIEW

SELECT B.TITLE, B.AUTHOR, R.REVIEWER_NAME
FROM BOOKS B
JOIN REVIEW R ON B.ID = R.BOOKID;


--2 

CREATE TABLE REVIEWS(
ID INT,
BOOKID INT,
REVIEWER_NAME  VARCHAR(30),
CONTENT VARCHAR(50),
RATING INT,
PUBLISHED_DATE DATETIME,
FOREIGN KEY(BOOKID) REFERENCES BOOKS(ID)
);
INSERT INTO REVIEWS(ID,BOOKID,REVIEWER_NAME,CONTENT,RATING,PUBLISHED_DATE)
VALUES
(1,1,'JOHN SMITH','My first Review',4,'2017-12-10 05:50:11'),
(2,2,'JOHN SMITH',' My Second Review',5,'2017-10-13 15:05:12'),
(3,2,'ALICE REVIEW','Another Review',1,'2017-10-22 23:47:10');
SELECT REVIEWER_NAME FROM REVIEWS GROUP BY REVIEWER_NAME HAVING COUNT(BOOKID) > 1;

--4 Write a query to display the Date,Total no of customer placed order on same Dat

CREATE TABLE ORDERS(
OID INT ,
DATES DATE,
CUSTOMER_ID INT FOREIGN KEY REFERENCES CUSTOMER(ID),
AMOUNT NUMERIC
);

INSERT INTO ORDERS(OID ,DATES,CUSTOMER_ID,AMOUNT) VALUES(102,'2009/10/08 00:00:00',3,3000),
(100,'2009/10/08 00:00:00',3,1500),(101,'2009/11/20 00:00:00',2,1560),
(103,'2008/05/20 00:00:00',4,2060);

SELECT * FROM ORDERS

SELECT DATES, COUNT(DISTINCT CUSTOMER_ID) AS TOTAL_CUSTOMERS
FROM ORDERS
GROUP BY DATES;

--5 Display the Names of the Employee in lower case, whose salary is null 

CREATE TABLE EMPLOYEES (
ID INT PRIMARY KEY,
ENAME VARCHAR(40) NOT NULL,
AGE INT,
EADDRESS VARCHAR(30),
SALARY FLOAT
);

INSERT INTO EMPLOYEES (ID, ENAME, AGE, EADDRESS, SALARY)
VALUES
    (1, 'RAMESH', 32, 'AHMEDABAD', 2000.00),
    (2, 'KHILAN', 25, 'DELHI', 1500.00),
    (3, 'KAUSHIK', 23, 'KOTA', 2000.00),
    (4, 'CHAITALI', 25, 'MUMBAI', 6500),
    (5, 'HARDIK', 27, 'BHOPAL', 8500),
    (6, 'KOMAL', 22, 'MP', NULL),
    (7, 'MUFFY', 24, 'INDORE', NULL);

SELECT * FROM EMPLOYEES

SELECT LOWER(ENAME) AS EMP_NAME
FROM EMPLOYEES
WHERE SALARY IS NULL;


--6 Write a sql server query to display the Gender,Total no of male and female from the aboverelation

CREATE TABLE STUDENTDETAILS(
REGISTERNO INT ,
SNAME VARCHAR(25),
AGE INT,
QUALIFICATION VARCHAR(10),
MOBILENO NUMERIC,
MAIL_ID VARCHAR(225),
SLOCATION VARCHAR(25),
GENDER VARCHAR(6)
);

INSERT INTO STUDENTDETAILS(REGISTERNO,SNAME,AGE,QUALIFICATION,MOBILENO,MAIL_ID,SLOCATION,GENDER)
VALUES (2,'SAI',22,'B.E',7623668781,'SAI@GMAIL.COM','CHENNAI','M'),
(3,'KUMAR',20,'BSC',374687341,'KUMAR@GMAIL.COM','MADHURAI','M'),
(4,'SELVI',22,'B TECH',389478231,'SELVI@GMAIL.COM','SELAM','F'),
(5,'NISHA',25,'M.E',23987489621,'NISHA@GMAIL.COM','THENI','F'),
(6,'SAI SARAN',21,'B.A',732768212,'SARAN@GMAIL.COM','MADHURAI','F'),
(7,'TOM',23,'BCA',98723623455,'TOM@GMAIL.COM','PUNE','M');

SELECT * FROM STUDENTDETAILS

SELECT GENDER, COUNT(*) AS TOTAL_MALE_FEMALE FROM STUDENTDETAILS GROUP BY GENDER


